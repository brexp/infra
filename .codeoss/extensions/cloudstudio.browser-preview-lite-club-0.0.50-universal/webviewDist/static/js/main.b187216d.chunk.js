(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){e.exports=n(59)},28:function(e,t,n){},29:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),c=n(22),s=n(2),i=n(3),l=n(5),u=n(4),h=n(1),d=n(6),g=(n(28),n(29),function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return a.createElement("div",{className:"loading-bar"},a.createElement("div",{className:"bar",style:this.getBarStyle()},a.createElement("div",{className:"peg"})))}},{key:"getBarStyle",value:function(){var e=this.props.percent;return{display:e>0?"block":"none",width:"".concat(e,"%")}}}]),t}(a.Component)),A=n(20),v=n.n(A),f=(n(54),n(55),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).ref=void 0,n.state={hasChanged:!1,isFocused:!1,url:e.url,urlSelectionStart:0,urlSelectionEnd:0,initUrl:""},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.handleFocus=n.handleFocus.bind(Object(h.a)(n)),n.handleBlur=n.handleBlur.bind(Object(h.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(h.a)(n)),n.setRef=n.setRef.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.url===this.state.url||this.state.hasChanged||this.setState({url:e.url,initUrl:this.state.initUrl||e.url})}},{key:"setUrl",value:function(e){var t=null;if(this.state.urlSelectionStart&&this.state.urlSelectionEnd){var n=this.state.url,a=n.slice(0,this.state.urlSelectionStart),r=n.slice(this.state.urlSelectionEnd);t=(a+e).length,e=a+e+r}else if(this.state.urlSelectionStart){var o=this.state.url,c=o.slice(0,this.state.urlSelectionStart),s=o.slice(this.state.urlSelectionStart);t=(c+e).length,e=c+e+s}e!==this.state.url&&(this.setState({url:e,hasChanged:!0,isFocused:!0}),this.ref&&t&&(this.ref.focus(),this.ref.setSelectionRange(t,t)))}},{key:"render",value:function(){var e=["urlbar"];return this.state.isFocused&&e.push("focused"),a.createElement("div",{className:e.join(" ")},a.createElement("input",{type:"text",ref:this.setRef,value:this.state.url,onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleKeyDown}))}},{key:"setRef",value:function(e){this.ref=e}},{key:"handleChange",value:function(e){this.setState({url:e.target.value,hasChanged:!0})}},{key:"handleFocus",value:function(e){this.selectUrl(e.target)}},{key:"selectUrl",value:function(e){!e&&this.ref&&(e=this.ref),e&&(e.select(),this.setState({isFocused:!0}))}},{key:"handleBlur",value:function(e){this.setState({isFocused:!1})}},{key:"enterUrl",value:function(){var e=this.state.url;if(""===e)e=this.state.initUrl,this.setState({url:e});else{e.match(/^(https?|about|chrome|file):/)||(e="https://"+this.state.url),e.match(/(\/|\\)$/)&&(e=e.slice(0,-1)),this.setState({hasChanged:!1})}this.props.onUrlChanged(e)}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.enterUrl()}}]),t}(a.Component)),p=n(10),b=(n(56),function(e){var t=e.value,n=e.options,o=e.onSelect,c=Object(a.useState)(t),s=Object(p.a)(c,2),i=s[0],l=s[1];Object(a.useEffect)(function(){l(t)},[t]);return r.a.createElement("select",{value:i,onChange:function(e){var t=e.target.value;l(t),o&&o(t)},className:"port-select"},n.map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))}),I=function(e,t){try{if(!t)return console.warn("\u9884\u89c8\u914d\u7f6e\u4e3a\u7a7a"),"";if(!e)return console.warn("\u7aef\u53e3\u53f7\u4e0d\u80fd\u4e3a\u7a7a"),"";var n=t.protocol,a=t.host,r=t.spaceKey,o=t.region,c=t.token,s={protocol:n,host:a,spaceKey:r},i=Object.entries(s).filter(function(e){var t=Object(p.a)(e,2);t[0];return!t[1]}).map(function(e){return Object(p.a)(e,1)[0]});if(i.length>0)return console.warn("\u7f3a\u5c11\u5fc5\u8981\u53c2\u6570: ".concat(i.join(", "))),"";var l="".concat(n,"://").concat(r);return function(e){return!!e}(o)?"".concat(l,"--").concat(e,".").concat(o,".").concat(a):c?"".concat(l,"-").concat(c,"-").concat(e,".").concat(a):(console.warn("\u65e0 region \u6a21\u5f0f\u4e0b token \u4e0d\u80fd\u4e3a\u7a7a"),"")}catch(u){return console.error("\u751f\u6210\u9884\u89c8URL\u65f6\u53d1\u751f\u9519\u8bef:",u),""}},k=function(){return document.getElementById("webviewIframe")},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return console.warn("setIframeSrcSafely: iframe element not found"),!1;var a=e.getAttribute("src");return n||a!==t?(console.log("setIframeSrcSafely: setting new URL",{currentSrc:a,newUrl:t,forceRefresh:n}),e.src=t,!0):(console.log("setIframeSrcSafely: URL is the same, skipping",{currentSrc:a,newUrl:t}),!1)}(k(),e,t)},y={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNNDI3IDIzNC42MjVIMTY3LjI5NmwxMTkuNzAyLTExOS43MDJMMjU2IDg1IDg1IDI1NmwxNzEgMTcxIDI5LjkyMi0yOS45MjQtMTE4LjYyNi0xMTkuNzAxSDQyN3YtNDIuNzV6Ii8+PC9zdmc+)"},w={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNODUgMjc3LjM3NWgyNTkuNzA0TDIyNS4wMDIgMzk3LjA3NyAyNTYgNDI3bDE3MS0xNzFMMjU2IDg1bC0yOS45MjIgMjkuOTI0IDExOC42MjYgMTE5LjcwMUg4NXY0Mi43NXoiLz48L3N2Zz4=)"},j={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNMjU2IDM4OGMtNzIuNTk3IDAtMTMyLTU5LjQwNS0xMzItMTMyIDAtNzIuNjAxIDU5LjQwMy0xMzIgMTMyLTEzMiAzNi4zIDAgNjkuMjk5IDE1LjQgOTIuNDA2IDM5LjYwMUwyNzggMjM0aDE1NFY4MGwtNTEuNjk4IDUxLjcwMkMzNDguNDA2IDk5Ljc5OCAzMDQuNDA2IDgwIDI1NiA4MGMtOTYuNzk3IDAtMTc2IDc5LjIwMy0xNzYgMTc2czc4LjA5NCAxNzYgMTc2IDE3NmM4MS4wNDUgMCAxNDguMjg3LTU0LjEzNCAxNjkuNDAxLTEyOEgzNzguODVjLTE4Ljc0NSA0OS41NjEtNjcuMTM4IDg0LTEyMi44NSA4NHoiLz48L3N2Zz4=)"},C={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADpSURBVHgBtZPBDcIwDEUtuJcBUCaABZpBOkF7B3pjiU7ABExAuXBrGQD1xI3OATb6gWC5ggP90pMa27HdOCEaQQlTMmemBzVTMU4HT9S6YI7MnVkxc7CGv0aMKXG0VpVIDp1llqNTmwvYWvxSHCu2JE5QgSAfdROqppG/VEnpwCxVFR+td6rtFAVe6mlYHh3os+l/SZChUmr4nnvCGG8DQVJ1zzTKvmAu8jGFYYZgHdgYNtGWuTKnYEjIvgNy0oXRVWfEUm4kcfQ57zDSnAaUI7vciXisnt7vI6Mvckgg9z48Jtm4Ud38Rw+hSTNuyuKbfgAAAABJRU5ErkJggg==)"},E={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADqSURBVHgB1VHBEYIwEAyBv5QQoADpAEqwAy3BErAD7QA6sATsQP+AVwINAO4xwXEwwjg+HPaTy83uXrInxL9hjRtKKde27c2kyLKoKIrcaOB53h2EK8r6k0HXdTE4p6qqjo5h6oHFTdPkRGQ0AX8Hg4jr3kBKmbRtu+an6QkKvRjlXszA0QIXgqwsy3Q8YQ5S/AhnjhAEAWfj6kzoawNOHMcKIfM1nTTA30Pxsj7OgsXaKPJ9P9J1iNCzNwMg5El47nAnEIUBGX6TPw2QeA3iFpsguPNdoX0bSFPoDSBOcMS8Tt2/oD6LReABdD1lrpwWsCsAAAAASUVORK5CYII=)"},M={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACDSURBVHgB7VNBCoAgEFy1h9gP+oSdI+gJ0Y+C3hBE5/xEP8h/RJgeBBNLyVs0ILKz7MwedgASgeyC1d2mPhqYEXwaclNgp0lVE+mnlIXlIgzvGmQ3LrBYLk/AkIhf4BMC3kNiTVugg1Q2Jwme+div8H6D3ctewlSqMMlAmHQuYs88CifEoh9KMXOn/wAAAABJRU5ErkJggg==)"},N=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).selectPort=function(e){var t=n.props.preLocConf;n.handleUrlChange(I(e,t)),n.handlePortChange(e);var a=k();a&&a.setAttribute("data-defaultport",e)},n.openInBrowser=function(e){n.props.onActionInvoked("openUrl",{url:e})},n.handleBack=n.handleBack.bind(Object(h.a)(n)),n.handleForward=n.handleForward.bind(Object(h.a)(n)),n.handleRefresh=n.handleRefresh.bind(Object(h.a)(n)),n.handleUrlChange=n.handleUrlChange.bind(Object(h.a)(n)),n.handleDoc=n.handleDoc.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.preLocConf||{},n=t.ports,r=void 0===n?"":n,o=t.port,c=void 0===o?"":o,s=t.currentPort,i=void 0===s?"":s;return a.createElement("div",{className:"toolbar"},a.createElement("div",{className:"inner"},a.createElement("a",{id:"openInBrowser",title:"Open In Browser",className:"openInbrowser",onClick:function(t){e.openInBrowser(e.props.url),t.preventDefault()}}),a.createElement("button",{className:"backward",title:"backward",style:y,onClick:this.handleBack,disabled:!this.props.canGoBack},"Backward"),a.createElement("button",{className:"forward",title:"forward",style:w,onClick:this.handleForward,disabled:!this.props.canGoForward},"Forward"),a.createElement("button",{className:"refresh",title:"refresh",style:j,onClick:this.handleRefresh},"Refresh"),a.createElement(b,{value:i||c,options:r.split(","),onSelect:function(t){e.selectPort(t)}}),a.createElement(f,{url:this.props.url,onUrlChanged:this.handleUrlChange,onActionInvoked:this.props.onActionInvoked}),a.createElement("button",{className:"doc",title:"doc",style:C,onClick:this.handleDoc},"doc"),a.createElement("button",{className:"device",title:"toggle device",style:E,onClick:this.handleDevice},"device"),a.createElement("button",{className:"QR-code",style:M,onMouseEnter:function(){return e.handleQRCodeMouseMove()}},a.createElement("div",{className:"QR-code-canvas"},a.createElement("canvas",{id:"canvas"}),a.createElement("span",null,"\u626b\u7801\u9884\u89c8\u79fb\u52a8\u7aef\u6548\u679c")))))}},{key:"renderCanvasQRCode",value:function(e){var t=document.getElementById("canvas");t&&(v.a.toCanvas(t,e),t.parentElement&&t.parentElement.setAttribute("display","block"),t.setAttribute("style","height: 120px;width: 120px;"))}},{key:"handleQRCodeMouseMove",value:function(){this.renderCanvasQRCode(this.props.url)}},{key:"handleDoc",value:function(){this.props.onActionInvoked("openDoc",{})}},{key:"handleDevice",value:function(){document.getElementById("device-box").classList.toggle("marvel-device");var e=document.getElementById("webviewIframe"),t=e.style.height;e.style.height="100%"===t?"100vh":"100%"}},{key:"handleUrlChange",value:function(e){this.props.onActionInvoked("urlChange",{url:e})}},{key:"handleBack",value:function(){this.props.onActionInvoked("backward",{})}},{key:"handleForward",value:function(){this.props.onActionInvoked("forward",{})}},{key:"handleRefresh",value:function(){this.props.onActionInvoked("refresh",{forceRefresh:!0})}},{key:"handlePortChange",value:function(e){this.props.onActionInvoked("portChange",{port:e})}}]),t}(a.Component),B=n(21),S=function(){function e(){Object(s.a)(this,e),this.enabled=!0}return Object(i.a)(e,[{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}},{key:"log",value:function(){var e;this.enabled&&(e=console).log.apply(e,arguments)}}]),e}(),D=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).lastId=void 0,e.vscode=void 0,e.callbacks=void 0,e.logger=void 0,e.lastId=0,e.callbacks=new Map,e.logger=new S,window.addEventListener("message",function(t){e.onMessage(t)}),e}return Object(d.a)(t,e),Object(i.a)(t,[{key:"send",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=++this.lastId;if(this.logger.log("SEND \u25ba ",e,n),!this.vscode)try{this.vscode=acquireVsCodeApi()}catch(r){this.vscode=null}return this.vscode&&this.vscode.postMessage({callbackId:a,params:n,type:e}),new Promise(function(n,r){t.callbacks.set(a,{resolve:n,reject:r,error:new Error,method:e})})}},{key:"onMessage",value:function(e){var t=e.data;if(t)if(t.callbackId){this.logger.log("\u25c0 RECV callbackId: ".concat(t.callbackId));var n=this.callbacks.get(t.callbackId);n&&(this.callbacks.delete(t.callbackId),t.error?n.reject(t.error,n.method,t):n.resolve(t.result))}else this.logger.log("\u25c0 RECV method: ".concat(t.method)),this.emit(t.method,t.result)}},{key:"enableVerboseLogging",value:function(e){e?this.logger.enable():this.logger.disable()}}]),t}(B.EventEmitter2),L=/(cloudstudio.net|cloudstudio.club)/i,O="about:blank",U=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).connection=new D,n.state={url:O,historyList:[],currentIndex:0,loadingPercent:0,history:{canGoBack:!1,canGoForward:!1},preLocConf:void 0},n.onToolbarActionInvoked=n.onToolbarActionInvoked.bind(Object(h.a)(n)),window.addEventListener("message",function(e){if(L.test(e.origin))switch(e.data.params.type){case"refresh":n.handleRefresh();break;case"learn-more":n.connection.send("Page.openUrl",{url:e.data.params.url});break;case"updateLocationConfig":n.setState({preLocConf:e.data.params.preLocConf})}}),n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){var t=document.querySelector("#webviewIframe"),n=t?t.dataset.defaulturl:"",a=t?t.dataset.defaulttitle:"";if(e.handleUrlChange({url:n,title:a}),t){var r=function(e){return["port","ports","protocol","host","spaceKey","token","addonpath","region"].reduce(function(t,n){return t[n]=e.dataset["default".concat(n).toLowerCase()]||"",t},{})}(t);e.setState({preLocConf:r})}})}},{key:"render",value:function(){var e=this.state,t=e.preLocConf,n=e.history,r=e.url,o=n.canGoBack,c=n.canGoForward;return a.createElement("div",{className:"App"},a.createElement(N,{url:r,onActionInvoked:this.onToolbarActionInvoked,canGoBack:o,canGoForward:c,preLocConf:t}),this.state.loadingPercent<100&&a.createElement(g,{percent:this.state.loadingPercent}))}},{key:"onToolbarActionInvoked",value:function(e,t){switch(e){case"forward":this.handleForward();break;case"backward":this.handleBackward();break;case"refresh":this.handleRefresh(t.forceRefresh);break;case"urlChange":this.handleUrlChange(t);break;case"openDoc":this.connection.send("Page.openDoc",{});break;case"openUrl":this.connection.send("Page.openUrl",{url:t.url});case"portChange":this.connection.send("Page.portChange",{})}}},{key:"handleLoadingBar",value:function(){var e=this,t=setInterval(function(){e.state.loadingPercent>=100?clearInterval(t):e.setState({loadingPercent:e.state.loadingPercent+20})},50)}},{key:"handleForward",value:function(){this.handleLoadingBar();var e=this.state.currentIndex+1;this.connection.send("Page.changeUrl",{url:this.state.historyList[e]});var t=k();t&&(t.src=this.state.historyList[e],document.getElementById("openInBrowser").href=this.state.historyList[e]),this.setState({url:this.state.historyList[e],currentIndex:e,loadingPercent:0,history:{canGoBack:0!==e,canGoForward:e!==this.state.historyList.length-1}})}},{key:"handleBackward",value:function(){this.handleLoadingBar();var e=this.state.currentIndex-1;this.connection.send("Page.changeUrl",{url:this.state.historyList[e]}),k()&&(k().src=this.state.historyList[e],document.getElementById("openInBrowser").href=this.state.historyList[e]),this.setState({url:this.state.historyList[e],currentIndex:e,loadingPercent:0,history:{canGoBack:0!==e,canGoForward:e!==this.state.historyList.length-1}})}},{key:"handleRefresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.handleLoadingBar(),this.connection.send("Page.changeUrl",{url:this.state.url}),m(this.state.url,e)&&(document.getElementById("openInBrowser").href=this.state.url),this.setState({loadingPercent:0})}},{key:"handleUrlChange",value:function(e){this.handleLoadingBar();var t=Object(c.a)(this.state.historyList);console.log("url info: > ",e),e.url!==t[t.length-1]&&t.push(e.url),this.connection.send("Page.changeUrl",{url:e.url,title:e.title});var n=e.url;m(n)&&(document.getElementById("openInBrowser").href=n),this.setState({historyList:t,url:e.url,loadingPercent:0,currentIndex:t.length-1,history:{canGoBack:t.length-1!==0,canGoForward:!1}})}}]),t}(a.Component);n(58);o.render(a.createElement(U,null),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.b187216d.chunk.js.map