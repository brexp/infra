(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){e.exports=n(59)},28:function(e,t,n){},29:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(18),s=n(21),c=n(2),i=n(3),l=n(5),d=n(4),h=n(1),u=n(6),A=(n(28),n(29),function(e){function t(e){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).call(this,e))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return a.createElement("div",{className:"loading-bar"},a.createElement("div",{className:"bar",style:this.getBarStyle()},a.createElement("div",{className:"peg"})))}},{key:"getBarStyle",value:function(){var e=this.props.percent;return{display:e>0?"block":"none",width:"".concat(e,"%")}}}]),t}(a.Component)),g=n(19),v=n.n(g),m=(n(54),n(55),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).ref=void 0,n.state={hasChanged:!1,isFocused:!1,url:e.url,urlSelectionStart:0,urlSelectionEnd:0,initUrl:""},n.handleChange=n.handleChange.bind(Object(h.a)(n)),n.handleFocus=n.handleFocus.bind(Object(h.a)(n)),n.handleBlur=n.handleBlur.bind(Object(h.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(h.a)(n)),n.setRef=n.setRef.bind(Object(h.a)(n)),n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.url===this.state.url||this.state.hasChanged||this.setState({url:e.url,initUrl:this.state.initUrl||e.url})}},{key:"setUrl",value:function(e){var t=null;if(this.state.urlSelectionStart&&this.state.urlSelectionEnd){var n=this.state.url,a=n.slice(0,this.state.urlSelectionStart),r=n.slice(this.state.urlSelectionEnd);t=(a+e).length,e=a+e+r}else if(this.state.urlSelectionStart){var o=this.state.url,s=o.slice(0,this.state.urlSelectionStart),c=o.slice(this.state.urlSelectionStart);t=(s+e).length,e=s+e+c}e!==this.state.url&&(this.setState({url:e,hasChanged:!0,isFocused:!0}),this.ref&&t&&(this.ref.focus(),this.ref.setSelectionRange(t,t)))}},{key:"render",value:function(){var e=["urlbar"];return this.state.isFocused&&e.push("focused"),a.createElement("div",{className:e.join(" ")},a.createElement("input",{type:"text",ref:this.setRef,value:this.state.url,onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleKeyDown}))}},{key:"setRef",value:function(e){this.ref=e}},{key:"handleChange",value:function(e){this.setState({url:e.target.value,hasChanged:!0})}},{key:"handleFocus",value:function(e){this.selectUrl(e.target)}},{key:"selectUrl",value:function(e){!e&&this.ref&&(e=this.ref),e&&(e.select(),this.setState({isFocused:!0}))}},{key:"handleBlur",value:function(e){this.setState({isFocused:!1})}},{key:"enterUrl",value:function(){var e=this.state.url;if(""===e)e=this.state.initUrl,this.setState({url:e});else{e.match(/^(https?|about|chrome|file):/)||(e="https://"+this.state.url),e.match(/(\/|\\)$/)&&(e=e.slice(0,-1)),this.setState({hasChanged:!1})}this.props.onUrlChanged(e)}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.enterUrl()}}]),t}(a.Component)),I=n(22),f=(n(56),function(e){var t=e.value,n=e.options,o=e.onSelect,s=Object(a.useState)(t),c=Object(I.a)(s,2),i=c[0],l=c[1];Object(a.useEffect)(function(){l(t)},[t]);return r.a.createElement("select",{value:i,onChange:function(e){var t=e.target.value;l(t),o&&o(t)},className:"port-select"},n.map(function(e){return r.a.createElement("option",{key:e,value:e},e)}))}),b={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNNDI3IDIzNC42MjVIMTY3LjI5NmwxMTkuNzAyLTExOS43MDJMMjU2IDg1IDg1IDI1NmwxNzEgMTcxIDI5LjkyMi0yOS45MjQtMTE4LjYyNi0xMTkuNzAxSDQyN3YtNDIuNzV6Ii8+PC9zdmc+)"},y={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNODUgMjc3LjM3NWgyNTkuNzA0TDIyNS4wMDIgMzk3LjA3NyAyNTYgNDI3bDE3MS0xNzFMMjU2IDg1bC0yOS45MjIgMjkuOTI0IDExOC42MjYgMTE5LjcwMUg4NXY0Mi43NXoiLz48L3N2Zz4=)"},k={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNMjU2IDM4OGMtNzIuNTk3IDAtMTMyLTU5LjQwNS0xMzItMTMyIDAtNzIuNjAxIDU5LjQwMy0xMzIgMTMyLTEzMiAzNi4zIDAgNjkuMjk5IDE1LjQgOTIuNDA2IDM5LjYwMUwyNzggMjM0aDE1NFY4MGwtNTEuNjk4IDUxLjcwMkMzNDguNDA2IDk5Ljc5OCAzMDQuNDA2IDgwIDI1NiA4MGMtOTYuNzk3IDAtMTc2IDc5LjIwMy0xNzYgMTc2czc4LjA5NCAxNzYgMTc2IDE3NmM4MS4wNDUgMCAxNDguMjg3LTU0LjEzNCAxNjkuNDAxLTEyOEgzNzguODVjLTE4Ljc0NSA0OS41NjEtNjcuMTM4IDg0LTEyMi44NSA4NHoiLz48L3N2Zz4=)"},w={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADpSURBVHgBtZPBDcIwDEUtuJcBUCaABZpBOkF7B3pjiU7ABExAuXBrGQD1xI3OATb6gWC5ggP90pMa27HdOCEaQQlTMmemBzVTMU4HT9S6YI7MnVkxc7CGv0aMKXG0VpVIDp1llqNTmwvYWvxSHCu2JE5QgSAfdROqppG/VEnpwCxVFR+td6rtFAVe6mlYHh3os+l/SZChUmr4nnvCGG8DQVJ1zzTKvmAu8jGFYYZgHdgYNtGWuTKnYEjIvgNy0oXRVWfEUm4kcfQ57zDSnAaUI7vciXisnt7vI6Mvckgg9z48Jtm4Ud38Rw+hSTNuyuKbfgAAAABJRU5ErkJggg==)"},p={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADqSURBVHgB1VHBEYIwEAyBv5QQoADpAEqwAy3BErAD7QA6sATsQP+AVwINAO4xwXEwwjg+HPaTy83uXrInxL9hjRtKKde27c2kyLKoKIrcaOB53h2EK8r6k0HXdTE4p6qqjo5h6oHFTdPkRGQ0AX8Hg4jr3kBKmbRtu+an6QkKvRjlXszA0QIXgqwsy3Q8YQ5S/AhnjhAEAWfj6kzoawNOHMcKIfM1nTTA30Pxsj7OgsXaKPJ9P9J1iNCzNwMg5El47nAnEIUBGX6TPw2QeA3iFpsguPNdoX0bSFPoDSBOcMS8Tt2/oD6LReABdD1lrpwWsCsAAAAASUVORK5CYII=)"},E={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACDSURBVHgB7VNBCoAgEFy1h9gP+oSdI+gJ0Y+C3hBE5/xEP8h/RJgeBBNLyVs0ILKz7MwedgASgeyC1d2mPhqYEXwaclNgp0lVE+mnlIXlIgzvGmQ3LrBYLk/AkIhf4BMC3kNiTVugg1Q2Jwme+div8H6D3ctewlSqMMlAmHQuYs88CifEoh9KMXOn/wAAAABJRU5ErkJggg==)"},j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleBack=n.handleBack.bind(Object(h.a)(n)),n.handleForward=n.handleForward.bind(Object(h.a)(n)),n.handleRefresh=n.handleRefresh.bind(Object(h.a)(n)),n.handleUrlChange=n.handleUrlChange.bind(Object(h.a)(n)),n.handleDoc=n.handleDoc.bind(Object(h.a)(n)),n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.preLocConf,n=t||{},r=n.ports,o=void 0===r?"":r,s=n.port,c=void 0===s?"":s;return a.createElement("div",{className:"toolbar"},a.createElement("div",{className:"inner"},a.createElement("button",{className:"backward",title:"backward",style:b,onClick:this.handleBack,disabled:!this.props.canGoBack},"Backward"),a.createElement("button",{className:"forward",title:"forward",style:y,onClick:this.handleForward,disabled:!this.props.canGoForward},"Forward"),a.createElement("button",{className:"refresh",title:"refresh",style:k,onClick:this.handleRefresh},"Refresh"),a.createElement(f,{value:c,options:o.split(","),onSelect:function(n){e.handleUrlChange(function(e,t){if(!t)return"";var n=t.protocol,a=t.host,r=t.spacekey,o=t.token,s=t.addonpath,c="".concat(n,"://").concat(r,"-").concat(o,"-").concat(e,".").concat(a);return s&&(c+="/".concat(s)),c}(n,t));var a=document.getElementById("webviewIframe");a&&a.setAttribute("data-defaultport",n)}}),a.createElement(m,{url:this.props.url,onUrlChanged:this.handleUrlChange,onActionInvoked:this.props.onActionInvoked}),a.createElement("button",{className:"doc",title:"doc",style:w,onClick:this.handleDoc},"doc"),a.createElement("button",{className:"device",title:"toggle device",style:p,onClick:this.handleDevice},"device"),a.createElement("button",{className:"QR-code",style:E,onMouseEnter:function(){return e.handleQRCodeMouseMove()}},a.createElement("div",{className:"QR-code-canvas"},a.createElement("canvas",{id:"canvas"}),a.createElement("span",null,"\u626b\u7801\u9884\u89c8\u79fb\u52a8\u7aef\u6548\u679c")))))}},{key:"renderCanvasQRCode",value:function(e){var t=document.getElementById("canvas");t&&(v.a.toCanvas(t,e),t.setAttribute("style","height: 120px;width: 120px;"))}},{key:"handleQRCodeMouseMove",value:function(){this.renderCanvasQRCode(this.props.url)}},{key:"handleDoc",value:function(){this.props.onActionInvoked("openDoc",{})}},{key:"handleDevice",value:function(){document.getElementById("device-box").classList.toggle("marvel-device");var e=document.getElementById("webviewIframe"),t=e.style.height;e.style.height="100%"===t?"100vh":"100%"}},{key:"handleUrlChange",value:function(e){this.props.onActionInvoked("urlChange",{url:e})}},{key:"handleBack",value:function(){this.props.onActionInvoked("backward",{})}},{key:"handleForward",value:function(){this.props.onActionInvoked("forward",{})}},{key:"handleRefresh",value:function(){this.props.onActionInvoked("refresh",{})}}]),t}(a.Component),M=n(20),N=function(){function e(){Object(c.a)(this,e),this.enabled=!0}return Object(i.a)(e,[{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}},{key:"log",value:function(){var e;this.enabled&&(e=console).log.apply(e,arguments)}}]),e}(),B=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(d.a)(t).call(this))).lastId=void 0,e.vscode=void 0,e.callbacks=void 0,e.logger=void 0,e.lastId=0,e.callbacks=new Map,e.logger=new N,window.addEventListener("message",function(t){e.onMessage(t)}),e}return Object(u.a)(t,e),Object(i.a)(t,[{key:"send",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=++this.lastId;if(this.logger.log("SEND \u25ba ",e,n),!this.vscode)try{this.vscode=acquireVsCodeApi()}catch(r){this.vscode=null}return this.vscode&&this.vscode.postMessage({callbackId:a,params:n,type:e}),new Promise(function(n,r){t.callbacks.set(a,{resolve:n,reject:r,error:new Error,method:e})})}},{key:"onMessage",value:function(e){var t=e.data;if(t)if(t.callbackId){this.logger.log("\u25c0 RECV callbackId: ".concat(t.callbackId));var n=this.callbacks.get(t.callbackId);n&&(this.callbacks.delete(t.callbackId),t.error?n.reject(t.error,n.method,t):n.resolve(t.result))}else this.logger.log("\u25c0 RECV method: ".concat(t.method)),this.emit(t.method,t.result)}},{key:"enableVerboseLogging",value:function(e){e?this.logger.enable():this.logger.disable()}}]),t}(M.EventEmitter2),C=/cloudstudio.net/i,D="about:blank",S=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).connection=new B,n.state={url:D,historyList:[],currentIndex:0,loadingPercent:0,history:{canGoBack:!1,canGoForward:!1},preLocConf:void 0},n.onToolbarActionInvoked=n.onToolbarActionInvoked.bind(Object(h.a)(n)),window.addEventListener("message",function(e){if(C.test(e.origin))switch(e.data.params.type){case"refresh":n.handleRefresh();break;case"learn-more":n.connection.send("Page.openUrl",{url:e.data.params.url})}}),n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){var t=document.querySelector("#webviewIframe"),n=t?t.dataset.defaulturl:"";if(e.handleUrlChange({url:n}),t){var a=function(e){return["port","ports","protocol","host","spacekey","token","addonpath"].reduce(function(t,n){return t[n]=e.dataset["default".concat(n)]||"",t},{})}(t);e.setState({preLocConf:a})}})}},{key:"render",value:function(){var e=this.state,t=e.preLocConf,n=e.history,r=e.url,o=n.canGoBack,s=n.canGoForward;return a.createElement("div",{className:"App"},a.createElement(j,{url:r,onActionInvoked:this.onToolbarActionInvoked,canGoBack:o,canGoForward:s,preLocConf:t}),this.state.loadingPercent<100&&a.createElement(A,{percent:this.state.loadingPercent}))}},{key:"onToolbarActionInvoked",value:function(e,t){switch(e){case"forward":this.handleForward();break;case"backward":this.handleBackward();break;case"refresh":this.handleRefresh();break;case"urlChange":this.handleUrlChange(t);break;case"openDoc":this.connection.send("Page.openDoc",{})}}},{key:"handleLoadingBar",value:function(){var e=this,t=setInterval(function(){e.state.loadingPercent>=100?clearInterval(t):e.setState({loadingPercent:e.state.loadingPercent+20})},50)}},{key:"handleForward",value:function(){this.handleLoadingBar();var e=this.state.currentIndex+1;this.connection.send("Page.changeUrl",{url:this.state.historyList[e]}),document.getElementById("webviewIframe")&&(document.getElementById("webviewIframe").src=this.state.historyList[e],document.getElementById("openInBrowser").href=this.state.historyList[e]),this.setState({url:this.state.historyList[e],currentIndex:e,loadingPercent:0,history:{canGoBack:0!==e,canGoForward:e!==this.state.historyList.length-1}})}},{key:"handleBackward",value:function(){this.handleLoadingBar();var e=this.state.currentIndex-1;this.connection.send("Page.changeUrl",{url:this.state.historyList[e]}),document.getElementById("webviewIframe")&&(document.getElementById("webviewIframe").src=this.state.historyList[e],document.getElementById("openInBrowser").href=this.state.historyList[e]),this.setState({url:this.state.historyList[e],currentIndex:e,loadingPercent:0,history:{canGoBack:0!==e,canGoForward:e!==this.state.historyList.length-1}})}},{key:"handleRefresh",value:function(){this.handleLoadingBar(),this.connection.send("Page.changeUrl",{url:this.state.url}),document.getElementById("webviewIframe")&&(document.getElementById("webviewIframe").src=this.state.url,document.getElementById("openInBrowser").href=this.state.url),this.setState({loadingPercent:0})}},{key:"handleUrlChange",value:function(e){this.handleLoadingBar();var t=Object(s.a)(this.state.historyList);console.log("url info: > ",e),e.url!==t[t.length-1]&&t.push(e.url),this.connection.send("Page.changeUrl",{url:e.url}),document.getElementById("webviewIframe")&&(document.getElementById("webviewIframe").src=e.url,document.getElementById("openInBrowser").href=e.url),this.setState({historyList:t,url:e.url,loadingPercent:0,currentIndex:t.length-1,history:{canGoBack:t.length-1!==0,canGoForward:!1}})}}]),t}(a.Component);n(58);o.render(a.createElement(S,null),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.9b92e12f.chunk.js.map